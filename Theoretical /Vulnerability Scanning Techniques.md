
# Scan types

Different scans are used to inspect different layers of an organization's technology stack.
## Network scanning

To find active hosts on a network and identify open ports, running services like web server, database, mail server and operating system versions on those hosts.

most common tool we use in network scanning is nmap.

#### 1. Basic Network scan
```
nmap 192.168.1.0/24
```

### 2. Scanning for Specific Ports

to scan specific port use -p
``` 
nmap -p 80 192.168.1.0/24
```

### 3. Service Version Detection

use -sV to check the version information of service running on open ports

```
nmap -sV 192.168.1.0/24
```

it gives detailed list of open ports and service running on them including version information 

### 4. OS detection
we use -O option to detect operating system on devices in network

```
sudo nmap -O 192.168.1.0/24
```

### 5. Aggressive scan

in aggressive scan  -A  . we get OS information, version information,  script scanning and traceroute.

```
sudo nmap -A 192.168.1.0/24
```

### 6. Stealth  Scan - TCP SYN scan
 stealth scan, is the default for privileged users. It sends a SYN packet and awaits a SYN/ACK response. If it gets one, the port is open, and Nmap immediately sends a RST packet to tear down the connection before it's completed, making it less likely to be logged.
```
sudo nmap -sS 192.168.1.0/24
```


now some advanced scans

https://www.notion.so/shubhamk06/Nmap-Advanced-Port-Scans-TryHackMe-THM-notes-35642e44fd5a49ffb93a3f6422b78e94?source=copy_link



 
## Application scanning

To find vulnerabilities within the code and configuration of a specific application, most commonly a web application. It goes deeper than a network scan, testing for flaws like SQL Injection, Cross-Site Scripting (XSS), and insecure configurations.

###  Nikto  scan 


```
nikto -host target.com
```

###  Zed Attack Proxy tool 

zapproxy is easy to use open-source penetration testing tool. ZAP is designed specifically for testing web applications and is both flexible and extensible.
we can do automated scan or manual explore easily on web app. it has feature like active, passive scan. 
it provide alerts of the found vulnerability with there severity level which is easy to understand. and those alerts can be checked further to verify that vulnerabilty is true positive or false positive.



#### **Authenticated vs. Unauthenticated Scanning:**

- **Unauthenticated**: This is what an outsider sees - scanning without any login credentials
- **Authenticated**: Using valid credentials to scan - gives a much deeper view of potential issues

Think of it like inspecting a car - unauthenticated is checking from outside, authenticated is popping the hood and checking the engine.



# Vulnerability Scoring

once you find security vulnerabilities, you need to figure out which ones to fix first. That's where CVSS comes in - it's like a universal grading system for how bad vulnerabilities are. It gives each vulnerability a score from 0 to 10 (10 being the worst).

**Important thing to remember:** CVSS measures _severity_ NOT _risk_!

- Severity = how bad the vulnerability is on its own (like how sharp a knife is)
- Risk = severity + your specific situation (like whether that knife is locked away or sitting on your kitchen counter)

### CVSS v4.0 - The New Version (Late 2023)

They just released version 4.0 because the old version (3.1) had problems. Main issue? Everything was getting marked as "CRITICAL!" which is like crying wolf - when everything's critical, nothing really is. People got overwhelmed and started ignoring alerts.

The new version is trying to be smarter - it's not just about slapping a number on something anymore. It's about understanding the actual risk in YOUR specific environment.

## Breaking Down the v4.0 Components

Think of CVSS v4.0 like building blocks - you've got 4 main groups:

### 1. Base Metrics (CVSS-B) - The Permanent Stuff

These are the things about a vulnerability that never change:

- **Attack Vector**:  How the vulnerability can be exploited (e.g., Network, Adjacent, Local, Physical).
- **Attack Complexity**: Reflects the complexity of the exploit required to bypass defensive measures.
- **Attack Requirements** (NEW!): A new metric that captures prerequisite conditions of the vulnerable component itself that must be met for an attack to succeed (e.g., a race condition).
- **Privileges Required**:  The level of privilege an attacker must have before exploitation (None, Low, High).
- **User Interaction**: Does someone need to click something? Now it's more detailed:
    - None = works automatically
    - Passive = user just clicks a link
    - Active = user has to really do something specific
- **Impact on the Vulnerable System**: The impact on the Confidentiality, Integrity, and Availability of the vulnerable system itself.
- **Impact on Other Systems** (replaces old "Scope"): the impact on the Confidentiality, Integrity, and Availability of other systems on the network. This replaces the ambiguous `Scope` metric from v3.1, providing a clearer assessment of cascading effects.

### 2. Threat Metrics (CVSS-BT) - The Stuff That Changes

 These reflect characteristics that can change over time, such as the availability of exploit code.
- Exploit Maturity (E): Measures the likelihood of an attack based on the current state of exploitation techniques (e.g., Proof-of-Concept code available, or actively Attacked in the wild).
- simpler words - exploit maturity :  Is there actual code out there to exploit this? Is it being used in the wild already?

### 3. Environmental Metrics (CVSS-BE) - Your Specific Situation

This is where you customize based on YOUR environment:

- You can override base metrics if you have protections in place
- You can say how important different aspects are for YOUR systems

### 4. Supplemental Metrics (NEW!) - Extra Context

These don't change the score but give useful info:

- **Automatable**: Can attackers hit multiple targets at once?
- **Recovery**: Does the system bounce back automatically or is it toast?
- **Value Density**: Is it worth the attacker's time? (Stealing one credit card vs thousands)
- **Response Effort**: How hard is it for defenders to fix?
- **Provider Urgency**: What does the vendor think? (Red/Amber/Green)

## New Naming System in CVSS

They realized people were just using the base score for everything, which misses the point. So now they name scores based on what went into them:

- **CVSS-B**: Just the basics (least accurate for your situation)
- **CVSS-BT**: Basics + current threat info
- **CVSS-BE**: Basics + your environment
- **CVSS-BTE**: Everything! (This is what you really want - the full picture)

## What Changed from v3.1 to v4.0 (The Important Stuff)

#### Table: CVSS v3.1 vs. v4.0 Key Changes

| Feature               | CVSS v3.1                                                                            | CVSS v4.0                                                                                                                     | Rationale for Change                                                                                  |
| --------------------- | ------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------- |
| **Attack Complexity** | Single `Attack Complexity` (AC) metric.                                              | Split into `Attack Complexity` (AC) for defenses and `Attack Requirements` (AT) for target conditions.                        | To provide a more granular and accurate assessment of what makes an exploit difficult.                |
| **User Interaction**  | Binary values: `None` or `Required`.                                                 | Granular values: `None`, `Passive`, or `Active`.                                                                              | To better reflect the level of user interaction needed for a successful exploit.                      |
| **Scope / Impact**    | Single `Scope` metric to indicate impact on other components.                        | `Scope` is retired. Replaced with explicit impact metrics for Vulnerable System (VC/VI/VA) and Subsequent Systems (SC/SI/SA). | To remove ambiguity and provide a clearer, more direct measure of impact across system boundaries.    |
| **Temporal Metrics**  | Named "Temporal Metric Group." Included `Remediation Level` and `Report Confidence`. | Renamed to "Threat Metric Group." Retired `RL` and `RC`. Renamed `Exploit Code Maturity` to `Exploit Maturity` (E).           | To simplify the group and focus on the most relevant threat intelligence factor: exploitability.      |
| **New Metric Groups** | N/A                                                                                  | Added "Supplemental Metric Group" (e.g., Automatable, Recovery, Provider Urgency).                                            | To provide additional, valuable context for risk analysis without affecting the core numerical score. |






# False Positives and Negative

So basically, vulnerability scanning isn't perfect - it's like having a conversation between the automated tools (doing the heavy lifting) and humans (making sure it's actually right). The scanners are fast and can check tons of stuff, BUT they mess up sometimes and need us humans to double-check their work.

NIST guidelines are pretty clear about this → always manually validate what the scanner spits out!

---

### Two Types of Scanner Mess-ups:

**1. False Positive - The "Crying Wolf" Problem

- Scanner says: "DANGER! Vulnerability here!"
- Reality: Nothing's actually wrong
- Think of it like: Your smoke alarm screaming because you burnt your toast - annoying but not a real emergency
- Why it happens: Scanner can't tell the difference between normal stuff and actual problems sometimes

**2. False Negative -The SCARY One

- Scanner says: "All good here!"
- Reality: There's actually a vulnerability hiding
- Think of it like: Security guard walks past an unlocked window and doesn't notice - that's the one that keeps you up at night
- Why it happens: Scanner might not have checked that specific area (didn't crawl that part of the app)

### How to Deal with False Positives :

**Step 1: Don't Trust, Verify**

- Never just accept or dismiss findings
- Manually test EVERYTHING the scanner flags
- Remember: Tools give you data → You provide the brain power so test and confirm it 

**Step 2: Fix the Scanner Settings**

- Once confirmed as false positive, adjust the scanner so it stops crying wolf
- Options: tweak alert levels, set up specific rules, create "ignore lists" for known non-issues

**Step 3: Document Everything (CYA!)**

- Mark it as false positive in the tool/report
- Write down: Why it's false, proof, date checked
- Creates paper trail for audits later

**Step 4: Pay It Forward**

- Using open-source tools like OWASP ZAP? Report the false positive to developers
- Help make the tool better for everyone else

### True positive 
these are actually true vulnerability which we get in any system.


